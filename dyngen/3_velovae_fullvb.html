
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>VeloVAE (fullvb) benchmark on dyngen data &#8212; RegVelo&#39;s reproducibility repository</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'dyngen/3_velovae_fullvb';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="VeloVAE benchmark on dyngen data" href="3_velovae.html" />
    <link rel="prev" title="UniTVelo benchmark on dyngen data" href="3_unitvelo.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">RegVelo's reproducibility repository</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    RegVelo’s reproducibility repository
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Complexity scale analysis with mouse neural crest and Schwann cell datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../scale_mouse_neural_crest/1_split_scaling.html">Split mouse neural crest data into different scale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scale_mouse_neural_crest/2_scenic_stage.html">Construct pySCENIC GRN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scale_mouse_neural_crest/3_grn_preprocessing.html">Preprocess GRN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scale_mouse_neural_crest/3_regvelo.html">RegVelo-based analysis on murine NCC cell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scale_mouse_neural_crest/3_scvelo.html">scVelo application on murine neural crest data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scale_mouse_neural_crest/3_velovi.html">veloVI application on murine neural crest data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scale_mouse_neural_crest/4_cbc.html">Benchmark transition from hub cells to terminal states</a></li>

<li class="toctree-l1"><a class="reference internal" href="../scale_mouse_neural_crest/4_cell_fate_consistency.html">Evaluate consistency of velocity and cell fate probability across scale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scale_mouse_neural_crest/4_tsi.html">Benchmark Terminal State Identification</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Cell cycle (U2OS)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/1_data_preparation.html">Cell cycle data preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/2_regvelo.html">RegVelo benchmark on cell cycle data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/2_scvelo.html">scVelo benchmark on cell cycle data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/2_velovi.html">veloVI benchmark on cell cycle data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/2_tfvelo.html">TFvelo benchmark on cell cycle data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/2_unitvelo.html">UniTVelo benchmark on cell cycle data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/2_velovae_fullvb.html">veloVAE (fullvb) benchmark on cell cycle data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/2_velovae.html">veloVAE (VAE) benchmark on cell cycle data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/2_cell2fate.html">cell2fate benchmark on cell cycle data</a></li>






<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/2_dpt.html">DPT benchmark on cell cycle data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/2_celloracle.html">CellOracle benchmark on cell cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/2_grnboost2.html">GRNBoost2 benchmark on cell cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/2_splicejac.html">SpliceJAC benchmark on cell cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/2_correlation.html">Correlation benchmark on cell cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/3_comparison.html">Performance comparison of inference on cell cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/3_grn_influence.html">GRN influence on velocity inference with RegVelo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/3_grn_visualization.html">Visualize GRN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/4_data_preparation_nn.html">Prepare datasets with different neighborhood size</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/5_regvelo_nn.html">RegVelo benchmark on cell cycle data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/5_velovi_nn.html">veloVI benchmark on cell cycle data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle/6_comparison_nn.html">Performance comparison of inference on cell cycle</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Cell cycle (RPE1)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle_rpe1/1_data_preparation_rpe1.html">Cell cycle data preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle_rpe1/2_regvelo.html">RegVelo benchmark on cell cycle data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle_rpe1/3_celldancer.html">CellDancer benchmark on cell cycle data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle_rpe1/4_alpha_prediction.html">Benchmark transcription rate prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cell_cycle_rpe1/5_latent_time.html">Evaluate latent time prediction via redefining global latent time</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Pancreatic endocrinogenesis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/1_preprocessing.html">Basic preprocessing of the pancreatic endocrine dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/2_regvelo.html">RegVelo-based analyis of pancreatic endocrine data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/2_scvelo.html">scVelo-based analyis of pancreatic endocrine data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/3_comparison_tsi.html">TSI comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/4_cell_fate_analysis.html">Pancreatic endocrine cell fate analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/4_test_gene_regulation.html">Regulation is important for terminal state identification in pancreatic endocrine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/5_cell_cycle_analysis.html">E2f1 perturbation on pancreatic endocrine dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/6_e2f1_targets_analysis.html">Evaluate RegVelo predicted E2f1 downstream targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/7_repeat_regvelo.html">Robustness of RegVelo’s perturbation analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/8_perturbation_screening.html">Perturbation prediction on pancreatic endocrine via RegVelo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/9_repeat_velovi.html">veloVI-based analyis of pancreatic endocrine data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/10_benchmark_identifiability.html">Benchmark cell fate and velocity identifiability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/11_neurod2_analysis.html">Analyzing perturbation simulation results on pancreatic endocrine dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pancreatic_endocrinogenesis/11_screening_neurod2_targets.html">Neurod2 target analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hematopoiesis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/1_preprocessing.html">Basic preprocessing and analysis of the human hematopoiesis dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/2_regvelo.html">Regularized RegVelo-based analysis of hematopoiesis dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/2_regvelo_unregularized.html">RegVelo-based analysis of hematopoiesis dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/2_scvelo.html">scVelo-based analysis of hematopoiesis dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/2_velovi.html">veloVI-based analysis of hematopoiesis dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/3_comparison_gene_ranking.html">Comparing lineage-associated gene rankings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/3_comparison_uncertainty.html">Comparing uncertainty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/3_comparison_velocity.html">Performance comparison of inference on hematopoiesis dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/4_dynamo.html">Dynamo-based drivers analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/4_perturbation.html">Perturbation prediction on hematopoiesis dataset via RegVelo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/5_comparison_drivers.html">Comparison of driver TF ranking performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/6_cell_fate_motif.html">PU.1 and GATA1 perturbation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/7_robustness.html">Repeat run RegVelo and veloVI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hematopoiesis/8_comparison_robustness.html">Compare estimated velocity robustness between RegVelo and veloVI</a></li>






</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Zebrafish neural crest</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/1_ss3_analysis.html">Basic preprocessing and analysis of the zebrafish data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/2_regvelo.html">RegVelo-based analyis of zebrafish data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/2_scvelo.html">scVelo-based analyis of zebrafish data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/2_velovi.html">veloVI-based analyis of zebrafish data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/3_tsi_comparison.html">Terminal state identification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/4_driver_prediction.html">Early driver perturbation prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/4_perturbation.html">TFs perturbation prediction with RegVelo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/5_driver_prediction_comparison.html">Driver ranking benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/6_celloracle.html">CellOracle-based perturbation prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/6_dynamo.html">Dynamo-based perturbation analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/6_regvelo_perturbation.html">Using RegVelo to predict perturbation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/7_perturbation_benchmark.html">Perturbation prediction benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/8_perturb_seq_analysis.html">Perturb-seq data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/9_elf1_motif_analysis.html">elf1 perturbation simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/10_regulon_activity.html">Visualize regulon activity and expression dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/11_regulon_simulation.html">Run simple simulation via perturb nr2f5 targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish/12_regvelo_ablation.html">Perform ablation study to the regvelo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Smart-seq3 and perturb-seq combined analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../zebrafish_perturb/1_Perturb_seq_scanpy.html">Reannotation of pigment cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish_perturb/2_perturb_seq_ts.html">Evaluate the cell fate perturbation significance on perturb-seq</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish_perturb/3_regvelo_perturbation.html">Compute density depletion likelihood with RegVelo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish_perturb/3_dynamo.html">Dynamo-based perturbation analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish_perturb/3_celloracle.html">CellOracle-based perturbation prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zebrafish_perturb/4_benchmark.html">Benchmark perturbation prediction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Toy GRN data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../toy_grn/1_simulation.html">Simulation of toy GRN and cellular dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toy_grn/2_regvelo.html">RegVelo benchmark on toy GRN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toy_grn/2_scvelo.html">scVelo benchmark on toy GRN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toy_grn/2_velovi.html">veloVI benchmark on toy GRN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toy_grn/2_dpt.html">DPT benchmark on toy GRN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toy_grn/2_celloracle.html">CellOracle benchmark on toy GRN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toy_grn/2_grnboost2.html">GRNBoost2 benchmark on toy GRN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toy_grn/2_correlation.html">Correlation benchmark on toy GRN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toy_grn/3_comparison.html">Performance comparison of inference on toy GRN data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toy_grn/3_plot_toy_simulation_benchmark.html">Plot the results of Toy simulate results</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Dyngen-simulated data</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1_simulation.html">Simulate synthetic datasets with dyngen</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_data_conversion.html">Dyngen data preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_regvelo.html">RegVelo benchmark on dyngen data</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_scvelo.html">scVelo benchmark on dyngen data</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_velovi.html">veloVI benchmark on dyngen data</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_unitvelo.html">UniTVelo benchmark on dyngen data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">VeloVAE (fullvb) benchmark on dyngen data</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_velovae.html">VeloVAE benchmark on dyngen data</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_cell2fate.html">cell2fate benchmark on dyngen data</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_celloracle.html">CellOracle benchmark on dyngen data</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_grnboost2.html">GRNBoost2 benchmark on dyngen data</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_splicejac.html">spliceJAC benchmark on dyngen data</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_correlation.html">Correlation benchmark on dyngen data</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_comparison.html">Performance comparison of inference on dyngen data</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_velovi_benchmark.html">Using veloVI as baseline for RegVelo identifiability test</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_regvelo_benchmark.html">Prior GRN sensitivity evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_robustness_evaluation.html">Plot downstream metrics</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/theislab/regvelo_reproducibility" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/dyngen/3_velovae_fullvb.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>VeloVAE (fullvb) benchmark on dyngen data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#library-imports">Library imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-settings">General settings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constants">Constants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#velocity-pipeline">Velocity pipeline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-saving">Data saving</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="velovae-fullvb-benchmark-on-dyngen-data">
<h1>VeloVAE (fullvb) benchmark on dyngen data<a class="headerlink" href="#velovae-fullvb-benchmark-on-dyngen-data" title="Link to this heading">#</a></h1>
<p>Notebook benchmarks velocity and latent time inference using VeloVAE (fullvb) on dyngen-generated data.</p>
<section id="library-imports">
<h2>Library imports<a class="headerlink" href="#library-imports" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">velovae</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vv</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">anndata</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ad</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scvelo</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">scv</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">rgv_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">DATA_DIR</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rgv_tools.benchmarking</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_velocity_correlation</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/icb/yifan.chen/miniconda3/envs/regvelo-py310-velovae/lib/python3.10/site-packages/velovae/model/model_util.py:12: TqdmExperimentalWarning: Using `tqdm.autonotebook.tqdm` in notebook mode. Use `tqdm.tqdm` instead to force console mode (e.g. in jupyter console)
  from tqdm.autonotebook import trange
</pre></div>
</div>
</div>
</div>
</section>
<section id="general-settings">
<h2>General settings<a class="headerlink" href="#general-settings" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scv</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">COMPLEXITY</span> <span class="o">=</span> <span class="s2">&quot;complexity_1&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="constants">
<h2>Constants<a class="headerlink" href="#constants" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATASET</span> <span class="o">=</span> <span class="s2">&quot;dyngen&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SAVE_DATA</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">if</span> <span class="n">SAVE_DATA</span><span class="p">:</span>
    <span class="p">(</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="n">DATASET</span> <span class="o">/</span> <span class="n">COMPLEXITY</span> <span class="o">/</span> <span class="s2">&quot;results&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">(</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="n">DATASET</span> <span class="o">/</span> <span class="n">COMPLEXITY</span> <span class="o">/</span> <span class="s2">&quot;processed&quot;</span> <span class="o">/</span> <span class="s2">&quot;velovae_fullvb_vae&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SAVE_DATASETS</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">if</span> <span class="n">SAVE_DATASETS</span><span class="p">:</span>
    <span class="p">(</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="n">DATASET</span> <span class="o">/</span> <span class="n">COMPLEXITY</span> <span class="o">/</span> <span class="s2">&quot;trained_velovae_fullvb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="velocity-pipeline">
<h2>Velocity pipeline<a class="headerlink" href="#velocity-pipeline" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">velocity_correlation</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="p">(</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="n">DATASET</span> <span class="o">/</span> <span class="n">COMPLEXITY</span> <span class="o">/</span> <span class="s2">&quot;processed&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span> <span class="o">!=</span> <span class="s2">&quot;.zarr&quot;</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Run </span><span class="si">{</span><span class="n">cnt</span><span class="si">}</span><span class="s2">, file </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="n">adata</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_zarr</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">rate_prior</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;beta&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)}</span>
        <span class="n">vae</span> <span class="o">=</span> <span class="n">vv</span><span class="o">.</span><span class="n">VAE</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">dim_z</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">,</span> <span class="n">full_vb</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rate_prior</span><span class="o">=</span><span class="n">rate_prior</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">vae</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="s2">&quot;pca&quot;</span><span class="p">)</span>

        <span class="n">simulation_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="s2">&quot;simulation_&quot;</span><span class="p">))</span>
        <span class="c1"># Output velocity to adata object</span>
        <span class="n">vae</span><span class="o">.</span><span class="n">save_anndata</span><span class="p">(</span>
            <span class="n">adata</span><span class="p">,</span>
            <span class="s2">&quot;fullvb&quot;</span><span class="p">,</span>
            <span class="n">DATA_DIR</span> <span class="o">/</span> <span class="n">DATASET</span> <span class="o">/</span> <span class="n">COMPLEXITY</span> <span class="o">/</span> <span class="s2">&quot;processed&quot;</span> <span class="o">/</span> <span class="s2">&quot;velovae_fullvb_vae&quot;</span><span class="p">,</span>
            <span class="n">file_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;velovae_fullvb_</span><span class="si">{</span><span class="n">simulation_id</span><span class="si">}</span><span class="s2">.h5ad&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">adata</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s2">&quot;velocity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s2">&quot;fullvb_velocity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># save data</span>
        <span class="n">adata</span><span class="o">.</span><span class="n">write_zarr</span><span class="p">(</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="n">DATASET</span> <span class="o">/</span> <span class="n">COMPLEXITY</span> <span class="o">/</span> <span class="s2">&quot;trained_velovae_fullvb&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;trained_</span><span class="si">{</span><span class="n">simulation_id</span><span class="si">}</span><span class="s2">.zarr&quot;</span><span class="p">)</span>

        <span class="n">velocity_correlation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">get_velocity_correlation</span><span class="p">(</span>
                <span class="n">ground_truth</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s2">&quot;true_velocity&quot;</span><span class="p">],</span> <span class="n">estimated</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s2">&quot;velocity&quot;</span><span class="p">],</span> <span class="n">aggregation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># noqa: BLE001</span>
        <span class="c1"># Append np.nan in case of an error and optionally log the error</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">velocity_correlation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Run 0, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_29.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "31e7477f1cf4432ca3a4fdc647b1c4a9", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 347 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "eaa1b5f11b354b87a5bff2f1d7ea5765", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5ee90107968c4df89bef8ceebc6cd781", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
KS-test result: [1. 1. 1.]
Assign cluster 1 to repressive
Initial induction: 245, repression: 117/362
Learning Rate based on Data Sparsity: 0.0003
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********       Stage 1: Early Stop Triggered at epoch 314.       *********
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a9758afbb98d4b5f877b2bf2de477f46", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.147
Average Set Size: 21
*********     Round 1: Early Stop Triggered at epoch 530.    *********
Change in noise variance: 0.0336
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 579.    *********
Change in noise variance: 0.0112
Change in x0: 0.4009
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 605.    *********
Change in noise variance: 0.0027
Change in x0: 0.2125
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 631.    *********
Change in noise variance: 0.0019
Change in x0: 0.1521
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 638.    *********
Change in noise variance: 0.0005
Change in x0: 0.1149
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 669.    *********
Change in noise variance: 0.0000
Change in x0: 0.1100
*********             Velocity Refinement Round 7             *********
Stage 2: Early Stop Triggered at round 6.
*********              Finished. Total Time =   0 h :  1 m : 14 s             *********
Final: Train ELBO = 449.825,	Test ELBO = 438.798
Run 1, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_14.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ee0443f7e4ac408c9025038be8c24f77", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 594 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9a2abad305094a569e4a4e69afe6d19f", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d1cc03513cf94851b18f76c9ac90ccf6", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.48, 0.8228239539949498), (0.52, 0.3684353137855576)
KS-test result: [0. 1. 1.]
Initial induction: 484, repression: 180/664
Learning Rate based on Data Sparsity: 0.0001
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********       Stage 1: Early Stop Triggered at epoch 219.       *********
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e85f4f1c80914475b8829bb322337444", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.034
Average Set Size: 49
*********     Round 1: Early Stop Triggered at epoch 611.    *********
Change in noise variance: 0.1225
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 667.    *********
Change in noise variance: 0.0119
Change in x0: 1.1951
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 731.    *********
Change in noise variance: 0.0223
Change in x0: 0.4867
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 765.    *********
Change in noise variance: 0.0057
Change in x0: 0.2543
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 792.    *********
Change in noise variance: 0.0003
Change in x0: 0.1477
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 843.    *********
Change in noise variance: 0.0000
Change in x0: 0.1231
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 885.    *********
Change in noise variance: 0.0000
Change in x0: 0.1125
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 904.    *********
Change in noise variance: 0.0000
Change in x0: 0.0999
*********             Velocity Refinement Round 9             *********
*********     Round 9: Early Stop Triggered at epoch 951.    *********
Change in noise variance: 0.0000
Change in x0: 0.0826
*********             Velocity Refinement Round 10             *********
*********     Round 10: Early Stop Triggered at epoch 1020.    *********
Change in noise variance: 0.0000
Change in x0: 0.0774
*********             Velocity Refinement Round 11             *********
Stage 2: Early Stop Triggered at round 10.
*********              Finished. Total Time =   0 h :  1 m : 21 s             *********
Final: Train ELBO = -328.411,	Test ELBO = -399.075
Run 2, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_24.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8c8ecfec78304b1391137e7c50e3b8af", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 461 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a2eb2a111bf54336ab83b098cb69221c", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "bc89351aa7c54a13a6b05e372544db24", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.59, 0.7142859350405649), (0.41, 0.232624469824922)
(0.52, 0.8547149661103973), (0.48, 0.31938394948827814)
KS-test result: [0. 0. 1.]
Initial induction: 431, repression: 295/726
Learning Rate based on Data Sparsity: 0.0000
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********       Stage 1: Early Stop Triggered at epoch 9.       *********
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "be9811b1cc7a49fcad561e60a0894f86", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.027
Average Set Size: 20
*********     Round 1: Early Stop Triggered at epoch 18.    *********
Change in noise variance: 0.2489
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 27.    *********
Change in noise variance: 0.0050
Change in x0: 0.7320
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 36.    *********
Change in noise variance: 0.0006
Change in x0: 0.4852
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 45.    *********
Change in noise variance: 0.0000
Change in x0: 0.4468
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 54.    *********
Change in noise variance: 0.0000
Change in x0: 0.3849
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 63.    *********
Change in noise variance: 0.0000
Change in x0: 0.3637
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 72.    *********
Change in noise variance: 0.0000
Change in x0: 0.3499
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 81.    *********
Change in noise variance: 0.0000
Change in x0: 0.3190
*********             Velocity Refinement Round 9             *********
*********     Round 9: Early Stop Triggered at epoch 90.    *********
Change in noise variance: 0.0000
Change in x0: 0.2829
*********             Velocity Refinement Round 10             *********
*********     Round 10: Early Stop Triggered at epoch 99.    *********
Change in noise variance: 0.0000
Change in x0: 0.2803
*********             Velocity Refinement Round 11             *********
Stage 2: Early Stop Triggered at round 10.
*********              Finished. Total Time =   0 h :  0 m : 11 s             *********
Final: Train ELBO = -26919.023,	Test ELBO = -26492.256
Run 3, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_28.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ef8f212240c140079836d4171a709a6b", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 535 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "92b2fd09ff374a218534b1c09d55bad1", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "07f4598b824742739090bbaee2c1e3c0", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.39, 0.3808448852305928), (0.61, 0.852512757686449)
(0.46, 0.3875805469813231), (0.54, 0.7668672821296293)
KS-test result: [0. 0. 1.]
Initial induction: 374, repression: 190/564
Learning Rate based on Data Sparsity: 0.0002
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b726e530d6114983a34ca4f064e20c9a", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.005
Average Set Size: 22
Change in noise variance: 0.0401
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1541.    *********
Change in noise variance: 0.0371
Change in x0: 0.3644
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1573.    *********
Change in noise variance: 0.0020
Change in x0: 0.2457
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1580.    *********
Change in noise variance: 0.0007
Change in x0: 0.2023
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1587.    *********
Change in noise variance: 0.0000
Change in x0: 0.1785
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1594.    *********
Change in noise variance: 0.0000
Change in x0: 0.1505
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1631.    *********
Change in noise variance: 0.0000
Change in x0: 0.1245
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 1642.    *********
Change in noise variance: 0.0000
Change in x0: 0.1042
*********             Velocity Refinement Round 9             *********
*********     Round 9: Early Stop Triggered at epoch 1649.    *********
Change in noise variance: 0.0000
Change in x0: 0.0983
*********             Velocity Refinement Round 10             *********
Stage 2: Early Stop Triggered at round 9.
*********              Finished. Total Time =   0 h :  2 m : 12 s             *********
Final: Train ELBO = 468.052,	Test ELBO = 368.735
Run 4, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_6.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1811953ce03f4c228d4df699358330d8", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 537 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c74332c7ebcf4b1cb81ed0b61e527e0a", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e311022649f8451198ea2bb42ccfdb8f", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.62, 0.8793261681749559), (0.38, 0.26633114834984656)
(0.47, 0.7331318775651423), (0.53, 0.2511832966547218)
(0.47, 0.2994057734262461), (0.53, 0.8553113871195344)
KS-test result: [0. 0. 0.]
Initial induction: 404, repression: 343/747
Learning Rate based on Data Sparsity: 0.0000
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5959fd9d598c48618ae0ffc14b0ceb1d", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.039
Average Set Size: 20
*********     Round 1: Early Stop Triggered at epoch 1332.    *********
Change in noise variance: 0.1963
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1529.    *********
Change in noise variance: 0.0139
Change in x0: 0.7732
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1565.    *********
Change in noise variance: 0.0039
Change in x0: 0.5783
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1644.    *********
Change in noise variance: 0.0039
Change in x0: 0.5012
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1668.    *********
Change in noise variance: 0.0016
Change in x0: 0.3899
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1682.    *********
Change in noise variance: 0.0012
Change in x0: 0.3248
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1704.    *********
Change in noise variance: 0.0008
Change in x0: 0.3053
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 1725.    *********
Change in noise variance: 0.0000
Change in x0: 0.2925
*********             Velocity Refinement Round 9             *********
*********     Round 9: Early Stop Triggered at epoch 1732.    *********
Change in noise variance: 0.0000
Change in x0: 0.2847
*********             Velocity Refinement Round 10             *********
Stage 2: Early Stop Triggered at round 9.
*********              Finished. Total Time =   0 h :  2 m : 20 s             *********
Final: Train ELBO = -1471.624,	Test ELBO = -1560.258
Run 5, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_21.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8bbbc624df4e4d4991af3c3f54c68fde", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 398 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "629898d3c69c4cf5beb79c28cf235db5", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "00c9fceab3f44232be01642d00c6e169", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.49, 0.2987033192902373), (0.51, 0.7362158867554179)
KS-test result: [1. 1. 0.]
Initial induction: 334, repression: 127/461
Learning Rate based on Data Sparsity: 0.0001
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0517c93367eb437bacbea9b45f5ffd87", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.120
Average Set Size: 21
*********     Round 1: Early Stop Triggered at epoch 1484.    *********
Change in noise variance: 0.0695
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1640.    *********
Change in noise variance: 0.0120
Change in x0: 0.3772
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1656.    *********
Change in noise variance: 0.0045
Change in x0: 0.3035
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1762.    *********
Change in noise variance: 0.0031
Change in x0: 0.1700
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1821.    *********
Change in noise variance: 0.0010
Change in x0: 0.1158
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1838.    *********
Change in noise variance: 0.0000
Change in x0: 0.0891
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1864.    *********
Change in noise variance: 0.0000
Change in x0: 0.0845
*********             Velocity Refinement Round 8             *********
Stage 2: Early Stop Triggered at round 7.
*********              Finished. Total Time =   0 h :  2 m : 25 s             *********
Final: Train ELBO = 640.215,	Test ELBO = 555.901
Run 6, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_15.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "eb78836ac424463c840cc5a4d6737761", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 404 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e537cbdc9d4c44ce85ebf5c5137345cc", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "094c45b9c29545eda73297fb2962ffee", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.62, 0.8595902088131244), (0.38, 0.34409679076346833)
(0.53, 0.3502039273194398), (0.47, 0.8163727115188388)
KS-test result: [0. 1. 0.]
Initial induction: 300, repression: 144/444
Learning Rate based on Data Sparsity: 0.0002
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********       Stage 1: Early Stop Triggered at epoch 96.       *********
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "848d57355fea4cdda3f53aedf75f2410", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.229
Average Set Size: 106
*********     Round 1: Early Stop Triggered at epoch 468.    *********
Change in noise variance: 0.0993
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 485.    *********
Change in noise variance: 0.0213
Change in x0: 1.9274
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 516.    *********
Change in noise variance: 0.0172
Change in x0: 0.6222
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 583.    *********
Change in noise variance: 0.0014
Change in x0: 0.1822
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 619.    *********
Change in noise variance: 0.0002
Change in x0: 0.1456
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 628.    *********
Change in noise variance: 0.0000
Change in x0: 0.1414
*********             Velocity Refinement Round 7             *********
Stage 2: Early Stop Triggered at round 6.
*********              Finished. Total Time =   0 h :  0 m : 49 s             *********
Final: Train ELBO = -298.772,	Test ELBO = -338.227
Run 7, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_9.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "db121f368d8e45059405d77301c9627b", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 335 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "76e9ba6477304733a8535859fdffe320", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "bf9a2eae3ff346bd87ccfcad27ddebb6", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.48, 0.37222433101870206), (0.52, 0.7806380011489331)
KS-test result: [1. 0. 1.]
Initial induction: 263, repression: 97/360
Learning Rate based on Data Sparsity: 0.0003
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a442b91695fb413b919f4cea1a40c3f7", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.122
Average Set Size: 18
*********     Round 1: Early Stop Triggered at epoch 1284.    *********
Change in noise variance: 0.0227
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1355.    *********
Change in noise variance: 0.0034
Change in x0: 0.1830
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1424.    *********
Change in noise variance: 0.0002
Change in x0: 0.0994
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1503.    *********
Change in noise variance: 0.0000
Change in x0: 0.0784
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1515.    *********
Change in noise variance: 0.0000
Change in x0: 0.0766
*********             Velocity Refinement Round 6             *********
Stage 2: Early Stop Triggered at round 5.
*********              Finished. Total Time =   0 h :  1 m : 58 s             *********
Final: Train ELBO = 493.208,	Test ELBO = 467.782
Run 8, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_12.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f747f538a89145ef9172ffa5755f9e7b", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 387 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "dd32aa34f4b8411fa9db53dae48a38c9", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "14a35781cafb47699e474ad5a4c50f16", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.59, 0.8421974990559944), (0.41, 0.31546207430654916)
(0.58, 0.7390920693790617), (0.42, 0.1625623840425744)
(0.42, 0.2930600982138266), (0.58, 0.8332787740830282)
KS-test result: [0. 0. 0.]
Initial induction: 310, repression: 205/515
Learning Rate based on Data Sparsity: 0.0000
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 5, test iteration: 8
*********       Stage 1: Early Stop Triggered at epoch 9.       *********
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e0f7d0fb0b8f437693a67502b679bf36", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.030
Average Set Size: 17
*********     Round 1: Early Stop Triggered at epoch 18.    *********
Change in noise variance: 0.1949
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 27.    *********
Change in noise variance: 0.0019
Change in x0: 0.6673
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 36.    *********
Change in noise variance: 0.0007
Change in x0: 0.5220
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 45.    *********
Change in noise variance: 0.0000
Change in x0: 0.4418
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 54.    *********
Change in noise variance: 0.0000
Change in x0: 0.3789
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 63.    *********
Change in noise variance: 0.0000
Change in x0: 0.3652
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 72.    *********
Change in noise variance: 0.0000
Change in x0: 0.2934
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 81.    *********
Change in noise variance: 0.0000
Change in x0: 0.2694
*********             Velocity Refinement Round 9             *********
*********     Round 9: Early Stop Triggered at epoch 90.    *********
Change in noise variance: 0.0000
Change in x0: 0.2871
*********             Velocity Refinement Round 10             *********
Stage 2: Early Stop Triggered at round 9.
*********              Finished. Total Time =   0 h :  0 m :  8 s             *********
Final: Train ELBO = -23497.715,	Test ELBO = -24467.719
Run 9, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_19.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "930b54fcc5c34f0a8212d2fcb4fb2781", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 244 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "fc5ec733cd114e4e8cf48d1785bb1332", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "eee6b9c1c62e47c4af97829001200fd0", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.46, 0.3700403220994146), (0.54, 0.8355761602987493)
(0.60, 0.33766490672002036), (0.40, 0.7567183237756051)
KS-test result: [0. 1. 0.]
Initial induction: 164, repression: 102/266
Learning Rate based on Data Sparsity: 0.0002
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "534dd9a9d94e462e8b22f2fb1bdcb773", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.014
Average Set Size: 21
*********     Round 1: Early Stop Triggered at epoch 1206.    *********
Change in noise variance: 0.0339
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1363.    *********
Change in noise variance: 0.0081
Change in x0: 0.3134
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1370.    *********
Change in noise variance: 0.0016
Change in x0: 0.2070
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1446.    *********
Change in noise variance: 0.0008
Change in x0: 0.1656
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1453.    *********
Change in noise variance: 0.0000
Change in x0: 0.1375
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1537.    *********
Change in noise variance: 0.0000
Change in x0: 0.1147
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1544.    *********
Change in noise variance: 0.0000
Change in x0: 0.1026
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 1593.    *********
Change in noise variance: 0.0000
Change in x0: 0.0901
*********             Velocity Refinement Round 9             *********
*********     Round 9: Early Stop Triggered at epoch 1610.    *********
Change in noise variance: 0.0000
Change in x0: 0.0793
*********             Velocity Refinement Round 10             *********
*********     Round 10: Early Stop Triggered at epoch 1629.    *********
Change in noise variance: 0.0000
Change in x0: 0.0719
*********             Velocity Refinement Round 11             *********
Stage 2: Early Stop Triggered at round 10.
*********              Finished. Total Time =   0 h :  2 m :  4 s             *********
Final: Train ELBO = 268.584,	Test ELBO = 244.117
Run 10, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_4.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "009818c8e3d94549b3fed4b62ef791cc", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 454 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c008b42993924005ba10dac8516b85c8", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "fc7b92a248344ac8bd3afc031d81ddf7", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.59, 0.8009445508520957), (0.41, 0.36772632850943016)
KS-test result: [1. 0. 1.]
Initial induction: 368, repression: 111/479
Learning Rate based on Data Sparsity: 0.0003
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********       Stage 1: Early Stop Triggered at epoch 731.       *********
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "942dc872c68545a99d4da3c403813813", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.142
Average Set Size: 18
*********     Round 1: Early Stop Triggered at epoch 907.    *********
Change in noise variance: 0.0464
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 973.    *********
Change in noise variance: 0.0051
Change in x0: 0.2664
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1014.    *********
Change in noise variance: 0.0007
Change in x0: 0.1456
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1025.    *********
Change in noise variance: 0.0000
Change in x0: 0.1260
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1094.    *********
Change in noise variance: 0.0000
Change in x0: 0.1118
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1165.    *********
Change in noise variance: 0.0000
Change in x0: 0.1064
*********             Velocity Refinement Round 7             *********
Stage 2: Early Stop Triggered at round 6.
*********              Finished. Total Time =   0 h :  1 m : 33 s             *********
Final: Train ELBO = 587.956,	Test ELBO = 546.589
Run 11, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_13.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "32071c832b264e50b90fd3782ef2dc56", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 502 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "164af3d23fd84f9493ea5470c36aab02", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c0780a2a84414bbcb7282c3204e39c40", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
KS-test result: [1. 1. 1.]
Assign cluster 0 to repressive
Initial induction: 315, repression: 199/514
Learning Rate based on Data Sparsity: 0.0004
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********       Stage 1: Early Stop Triggered at epoch 579.       *********
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e2b9a764241d4322bbe604e27f3e22c2", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.049
Average Set Size: 20
*********     Round 1: Early Stop Triggered at epoch 900.    *********
Change in noise variance: 0.0355
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 962.    *********
Change in noise variance: 0.0139
Change in x0: 0.4108
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 969.    *********
Change in noise variance: 0.0025
Change in x0: 0.2712
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1051.    *********
Change in noise variance: 0.0009
Change in x0: 0.2049
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1075.    *********
Change in noise variance: 0.0000
Change in x0: 0.1712
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1106.    *********
Change in noise variance: 0.0000
Change in x0: 0.1455
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1125.    *********
Change in noise variance: 0.0000
Change in x0: 0.1236
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 1132.    *********
Change in noise variance: 0.0000
Change in x0: 0.1053
*********             Velocity Refinement Round 9             *********
*********     Round 9: Early Stop Triggered at epoch 1151.    *********
Change in noise variance: 0.0000
Change in x0: 0.0940
*********             Velocity Refinement Round 10             *********
*********     Round 10: Early Stop Triggered at epoch 1167.    *********
Change in noise variance: 0.0000
Change in x0: 0.0862
*********             Velocity Refinement Round 11             *********
Stage 2: Early Stop Triggered at round 10.
*********              Finished. Total Time =   0 h :  1 m : 32 s             *********
Final: Train ELBO = 571.016,	Test ELBO = 484.392
Run 12, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_2.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7eb4a5855a504eac91d7afaa0f80e1b6", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 424 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d076f783814f45ffb7f27b3afef3cea2", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6c5edea13bad460a91bf32706fdc17ba", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.63, 0.7924425318102936), (0.37, 0.25047287353531905)
(0.32, 0.39095042714182476), (0.68, 0.9377617670621354)
(0.51, 0.35416668477069335), (0.49, 0.8927600435275674)
KS-test result: [0. 0. 0.]
Initial induction: 431, repression: 259/690
Learning Rate based on Data Sparsity: 0.0000
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1c7967427c2c4298b6889eb6c8a2a34a", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.026
Average Set Size: 20
*********     Round 1: Early Stop Triggered at epoch 1012.    *********
Change in noise variance: 0.2075
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1021.    *********
Change in noise variance: 0.0034
Change in x0: 0.9044
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1030.    *********
Change in noise variance: 0.0019
Change in x0: 0.6653
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1039.    *********
Change in noise variance: 0.0003
Change in x0: 0.5567
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1046.    *********
Change in noise variance: 0.0000
Change in x0: 0.4385
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1053.    *********
Change in noise variance: 0.0000
Change in x0: 0.3859
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1060.    *********
Change in noise variance: 0.0000
Change in x0: 0.3471
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 1067.    *********
Change in noise variance: 0.0000
Change in x0: 0.3200
*********             Velocity Refinement Round 9             *********
*********     Round 9: Early Stop Triggered at epoch 1074.    *********
Change in noise variance: 0.0000
Change in x0: 0.3100
*********             Velocity Refinement Round 10             *********
Stage 2: Early Stop Triggered at round 9.
*********              Finished. Total Time =   0 h :  1 m : 30 s             *********
Final: Train ELBO = -1431.609,	Test ELBO = -1512.579
Run 13, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_16.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3ca1cfe13fef4a1d9b292efce325e7f8", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 481 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "05d816a989014fdca8bf85e3bd9a0f6c", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5e73e99728594a37a6e205ce0c9a48e7", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
KS-test result: [1. 1. 1.]
Assign cluster 1 to repressive
Initial induction: 325, repression: 211/536
Learning Rate based on Data Sparsity: 0.0002
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "dcfe044642064ac1ba39ca7f2614fd54", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.078
Average Set Size: 20
Change in noise variance: 0.0685
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1549.    *********
Change in noise variance: 0.0195
Change in x0: 0.2868
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1613.    *********
Change in noise variance: 0.0019
Change in x0: 0.2189
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1700.    *********
Change in noise variance: 0.0004
Change in x0: 0.1530
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1734.    *********
Change in noise variance: 0.0000
Change in x0: 0.1245
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1780.    *********
Change in noise variance: 0.0000
Change in x0: 0.1096
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1862.    *********
Change in noise variance: 0.0000
Change in x0: 0.0926
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 1901.    *********
Change in noise variance: 0.0000
Change in x0: 0.0744
*********             Velocity Refinement Round 9             *********
*********     Round 9: Early Stop Triggered at epoch 1922.    *********
Change in noise variance: 0.0000
Change in x0: 0.0624
*********             Velocity Refinement Round 10             *********
*********     Round 10: Early Stop Triggered at epoch 2086.    *********
Change in noise variance: 0.0000
Change in x0: 0.0577
*********             Velocity Refinement Round 11             *********
Stage 2: Early Stop Triggered at round 10.
*********              Finished. Total Time =   0 h :  2 m : 43 s             *********
Final: Train ELBO = 732.020,	Test ELBO = 631.934
Run 14, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_1.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8cf72f3ccf24482d82dbccc02dfa4555", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 345 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5a6e3f99bea5491e8c9a98518dd0f7c8", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cea6147daf6d41c59dd46f021abae2a3", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
KS-test result: [1. 1. 1.]
Assign cluster 1 to repressive
Initial induction: 232, repression: 136/368
Learning Rate based on Data Sparsity: 0.0004
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "accd54ebb2304e52b86c1bb17f2682b7", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.029
Average Set Size: 20
*********     Round 1: Early Stop Triggered at epoch 1422.    *********
Change in noise variance: 0.0486
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1458.    *********
Change in noise variance: 0.0091
Change in x0: 0.3043
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1482.    *********
Change in noise variance: 0.0005
Change in x0: 0.1621
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1568.    *********
Change in noise variance: 0.0000
Change in x0: 0.1108
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1575.    *********
Change in noise variance: 0.0000
Change in x0: 0.0903
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1586.    *********
Change in noise variance: 0.0000
Change in x0: 0.0703
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1610.    *********
Change in noise variance: 0.0000
Change in x0: 0.0597
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 1621.    *********
Change in noise variance: 0.0000
Change in x0: 0.0533
*********             Velocity Refinement Round 9             *********
Stage 2: Early Stop Triggered at round 8.
*********              Finished. Total Time =   0 h :  2 m :  7 s             *********
Final: Train ELBO = 558.691,	Test ELBO = 509.981
Run 15, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_18.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "66a81d02ed974536bb1f54322569445c", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 327 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6a389c5d861440999e4b9b755554f2cc", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a27af0a7b8904abda6c41437218fea23", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.51, 0.3274513378440137), (0.49, 0.8157796920163066)
KS-test result: [1. 1. 0.]
Initial induction: 264, repression: 100/364
Learning Rate based on Data Sparsity: 0.0002
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c1c938f0e13740e38f68d044f5296a46", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.034
Average Set Size: 20
Change in noise variance: 0.0658
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1572.    *********
Change in noise variance: 0.0105
Change in x0: 0.2625
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1616.    *********
Change in noise variance: 0.0015
Change in x0: 0.1819
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1725.    *********
Change in noise variance: 0.0004
Change in x0: 0.1387
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1816.    *********
Change in noise variance: 0.0000
Change in x0: 0.1053
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1943.    *********
Change in noise variance: 0.0000
Change in x0: 0.0764
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 2144.    *********
Change in noise variance: 0.0000
Change in x0: 0.0618
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 2200.    *********
Change in noise variance: 0.0000
Change in x0: 0.0553
*********             Velocity Refinement Round 9             *********
Stage 2: Early Stop Triggered at round 8.
*********              Finished. Total Time =   0 h :  2 m : 49 s             *********
Final: Train ELBO = 699.190,	Test ELBO = 641.937
Run 16, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_5.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e9198da425ed4af3ad034622c7525c64", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 262 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "df8aad840ede483ea04f2ea21fccb51b", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "dc43c73582e34a83a9b9041b9744ced4", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
KS-test result: [1. 1. 1.]
Assign cluster 1 to repressive
Initial induction: 182, repression: 100/282
Learning Rate based on Data Sparsity: 0.0003
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f21e14c1c9714071bc666b07bafaa783", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.141
Average Set Size: 18
*********     Round 1: Early Stop Triggered at epoch 1274.    *********
Change in noise variance: 0.0475
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1396.    *********
Change in noise variance: 0.0169
Change in x0: 0.2664
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1455.    *********
Change in noise variance: 0.0008
Change in x0: 0.1681
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1489.    *********
Change in noise variance: 0.0000
Change in x0: 0.1470
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1496.    *********
Change in noise variance: 0.0000
Change in x0: 0.1528
*********             Velocity Refinement Round 6             *********
Stage 2: Early Stop Triggered at round 5.
*********              Finished. Total Time =   0 h :  1 m : 57 s             *********
Final: Train ELBO = 238.936,	Test ELBO = 203.147
Run 17, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_10.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9c36e884cdd245cc8dfa14c1b3ac3968", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 306 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d68ae2a287bf4b358dba96c9bb69c72b", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9ad8641291b84aedadca6d90f9deda60", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.44, 0.21427183785803913), (0.56, 0.8053766111264617)
(0.65, 0.8997967816308998), (0.35, 0.35802780150367175)
KS-test result: [0. 1. 0.]
Initial induction: 379, repression: 169/548
Learning Rate based on Data Sparsity: 0.0000
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********       Stage 1: Early Stop Triggered at epoch 9.       *********
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "73cc8efc191944a18da2d115faf73a1f", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.035
Average Set Size: 19
*********     Round 1: Early Stop Triggered at epoch 30.    *********
Change in noise variance: 0.2346
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 37.    *********
Change in noise variance: 0.0073
Change in x0: 0.6161
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 44.    *********
Change in noise variance: 0.0039
Change in x0: 0.5040
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 51.    *********
Change in noise variance: 0.0018
Change in x0: 0.4250
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 60.    *********
Change in noise variance: 0.0007
Change in x0: 0.3543
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 67.    *********
Change in noise variance: 0.0000
Change in x0: 0.3236
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 74.    *********
Change in noise variance: 0.0000
Change in x0: 0.2708
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 81.    *********
Change in noise variance: 0.0000
Change in x0: 0.2704
*********             Velocity Refinement Round 9             *********
Stage 2: Early Stop Triggered at round 8.
*********              Finished. Total Time =   0 h :  0 m :  9 s             *********
Final: Train ELBO = -24367.305,	Test ELBO = -24067.287
Run 18, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_8.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f384fb6a9f024266b2d0e6ddaa8f1feb", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 397 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9855222033ac4b5fb526ebbbc18f9d5a", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "614a8448a32349fbb467d9646b1a5b16", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
KS-test result: [1. 1. 1.]
Assign cluster 0 to repressive
Initial induction: 295, repression: 167/462
Learning Rate based on Data Sparsity: 0.0003
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "01149f885a4141c382958814c9476087", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.024
Average Set Size: 20
*********     Round 1: Early Stop Triggered at epoch 1431.    *********
Change in noise variance: 0.0907
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1510.    *********
Change in noise variance: 0.0053
Change in x0: 0.2621
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1557.    *********
Change in noise variance: 0.0008
Change in x0: 0.1654
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1614.    *********
Change in noise variance: 0.0000
Change in x0: 0.1322
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1665.    *********
Change in noise variance: 0.0000
Change in x0: 0.1163
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1672.    *********
Change in noise variance: 0.0000
Change in x0: 0.1057
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1734.    *********
Change in noise variance: 0.0000
Change in x0: 0.0897
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 1801.    *********
Change in noise variance: 0.0000
Change in x0: 0.0756
*********             Velocity Refinement Round 9             *********
*********     Round 9: Early Stop Triggered at epoch 1828.    *********
Change in noise variance: 0.0000
Change in x0: 0.0694
*********             Velocity Refinement Round 10             *********
Stage 2: Early Stop Triggered at round 9.
*********              Finished. Total Time =   0 h :  2 m : 23 s             *********
Final: Train ELBO = 892.707,	Test ELBO = 736.356
Run 19, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_11.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a37e57504d0a4d16875e0aa8bfa5585e", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 346 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ad59da5e2fec4fb1a4ab62c2e44915ff", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "82978c1358ae47e58aa13ec2c1314c95", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.59, 0.8267164296804612), (0.41, 0.36831379905588)
KS-test result: [1. 0. 1.]
Initial induction: 291, repression: 86/377
Learning Rate based on Data Sparsity: 0.0002
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "62df88c0fc984684afa67ef570aaaf3d", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.141
Average Set Size: 18
*********     Round 1: Early Stop Triggered at epoch 1367.    *********
Change in noise variance: 0.0236
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1409.    *********
Change in noise variance: 0.0025
Change in x0: 0.1406
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1423.    *********
Change in noise variance: 0.0006
Change in x0: 0.0880
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1472.    *********
Change in noise variance: 0.0000
Change in x0: 0.0785
*********             Velocity Refinement Round 5             *********
Stage 2: Early Stop Triggered at round 4.
*********              Finished. Total Time =   0 h :  1 m : 55 s             *********
Final: Train ELBO = 504.837,	Test ELBO = 472.133
Run 20, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_27.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e1ab240bffc34e3bb1651c61102e772f", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 320 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "20f8b216e6b2419da0b0f827a2163883", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1a8eb05864564e9daf4fab56360c005c", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.39, 0.28728312975125536), (0.61, 0.8005818061651941)
KS-test result: [0. 1. 1.]
Initial induction: 289, repression: 92/381
Learning Rate based on Data Sparsity: 0.0002
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "aae0e01b83cd4ce39aeeb7e878e0c681", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.019
Average Set Size: 21
Change in noise variance: 0.0556
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1544.    *********
Change in noise variance: 0.0453
Change in x0: 0.3729
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1611.    *********
Change in noise variance: 0.0041
Change in x0: 0.2411
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1618.    *********
Change in noise variance: 0.0014
Change in x0: 0.1940
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1625.    *********
Change in noise variance: 0.0005
Change in x0: 0.1519
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1644.    *********
Change in noise variance: 0.0000
Change in x0: 0.1335
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1655.    *********
Change in noise variance: 0.0000
Change in x0: 0.1172
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 1664.    *********
Change in noise variance: 0.0000
Change in x0: 0.1075
*********             Velocity Refinement Round 9             *********
Stage 2: Early Stop Triggered at round 8.
*********              Finished. Total Time =   0 h :  2 m :  9 s             *********
Final: Train ELBO = 331.373,	Test ELBO = 255.813
Run 21, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_23.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9a46cdf69bca4c4b847596fa59056242", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 326 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ba7570d92fb24fdeb4069c23cf4e8e6e", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4ef89ef25599498aaa3e588e94010a62", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.51, 0.7911187894111076), (0.49, 0.37965464284669165)
KS-test result: [1. 1. 0.]
Initial induction: 264, repression: 95/359
Learning Rate based on Data Sparsity: 0.0003
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********       Stage 1: Early Stop Triggered at epoch 754.       *********
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9526bd51d96b480cac8ebe4b6f4a2a69", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.144
Average Set Size: 19
*********     Round 1: Early Stop Triggered at epoch 921.    *********
Change in noise variance: 0.0380
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 955.    *********
Change in noise variance: 0.0062
Change in x0: 0.2466
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 991.    *********
Change in noise variance: 0.0002
Change in x0: 0.1567
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 998.    *********
Change in noise variance: 0.0000
Change in x0: 0.1274
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1010.    *********
Change in noise variance: 0.0000
Change in x0: 0.1248
*********             Velocity Refinement Round 6             *********
Stage 2: Early Stop Triggered at round 5.
*********              Finished. Total Time =   0 h :  1 m : 20 s             *********
Final: Train ELBO = 486.095,	Test ELBO = 463.734
Run 22, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_17.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5169df343d3443ff876d77278fafaeea", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 410 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "965b5250af7f4fb9b8c3ace84069ba25", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "38a6ecaa75994d169978b3de4e7a97a9", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
KS-test result: [1. 1. 1.]
Assign cluster 1 to repressive
Initial induction: 284, repression: 166/450
Learning Rate based on Data Sparsity: 0.0004
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "21a3f531dace4fc289b9d1bdf2567abb", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.053
Average Set Size: 23
*********     Round 1: Early Stop Triggered at epoch 1434.    *********
Change in noise variance: 0.0677
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1681.    *********
Change in noise variance: 0.0075
Change in x0: 0.2493
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1787.    *********
Change in noise variance: 0.0007
Change in x0: 0.1443
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1848.    *********
Change in noise variance: 0.0000
Change in x0: 0.1204
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1955.    *********
Change in noise variance: 0.0000
Change in x0: 0.0924
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 2036.    *********
Change in noise variance: 0.0000
Change in x0: 0.0691
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 2213.    *********
Change in noise variance: 0.0000
Change in x0: 0.0653
*********             Velocity Refinement Round 8             *********
Stage 2: Early Stop Triggered at round 7.
*********              Finished. Total Time =   0 h :  2 m : 51 s             *********
Final: Train ELBO = 853.947,	Test ELBO = 717.942
Run 23, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_30.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a5e33e44133048a7a32d76d9e94273d4", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 404 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0a6d2d64c62d45ef99f7445ddd79ab71", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "99e4e1b2d65646398fa44f141bedb435", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.64, 0.7874540650534966), (0.36, 0.30795453403738815)
(0.67, 0.8559480355355736), (0.33, 0.3295921295742867)
KS-test result: [0. 0. 1.]
Initial induction: 337, repression: 128/465
Learning Rate based on Data Sparsity: 0.0000
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6a30fd1b05d5460f85fdee502fe9d23e", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.029
Average Set Size: 20
*********     Round 1: Early Stop Triggered at epoch 1271.    *********
Change in noise variance: 0.0555
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1280.    *********
Change in noise variance: 0.0262
Change in x0: 0.3258
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1312.    *********
Change in noise variance: 0.0027
Change in x0: 0.2685
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1338.    *********
Change in noise variance: 0.0012
Change in x0: 0.2391
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1362.    *********
Change in noise variance: 0.0015
Change in x0: 0.2168
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1413.    *********
Change in noise variance: 0.0014
Change in x0: 0.1821
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1430.    *********
Change in noise variance: 0.0011
Change in x0: 0.1758
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 1447.    *********
Change in noise variance: 0.0011
Change in x0: 0.1639
*********             Velocity Refinement Round 9             *********
*********     Round 9: Early Stop Triggered at epoch 1469.    *********
Change in noise variance: 0.0006
Change in x0: 0.1284
*********             Velocity Refinement Round 10             *********
*********     Round 10: Early Stop Triggered at epoch 1476.    *********
Change in noise variance: 0.0000
Change in x0: 0.1102
*********             Velocity Refinement Round 11             *********
*********     Round 11: Early Stop Triggered at epoch 1483.    *********
Change in noise variance: 0.0000
Change in x0: 0.0967
*********             Velocity Refinement Round 12             *********
*********     Round 12: Early Stop Triggered at epoch 1499.    *********
Change in noise variance: 0.0000
Change in x0: 0.0821
*********             Velocity Refinement Round 13             *********
*********     Round 13: Early Stop Triggered at epoch 1548.    *********
Change in noise variance: 0.0000
Change in x0: 0.0643
*********             Velocity Refinement Round 14             *********
*********     Round 14: Early Stop Triggered at epoch 1557.    *********
Change in noise variance: 0.0000
Change in x0: 0.0579
*********             Velocity Refinement Round 15             *********
Stage 2: Early Stop Triggered at round 14.
*********              Finished. Total Time =   0 h :  2 m :  4 s             *********
Final: Train ELBO = -2.364,	Test ELBO = -59.837
Run 24, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_22.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7c653dff4f594ed1b363635bd884eea5", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 393 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8359684073fa45088859829f18b7310d", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2e299ed571e34b0d894d85bbe26198c5", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.66, 0.7192424805256069), (0.34, 0.29799031256004654)
KS-test result: [0. 1. 1.]
Initial induction: 333, repression: 89/422
Learning Rate based on Data Sparsity: 0.0004
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********       Stage 1: Early Stop Triggered at epoch 989.       *********
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "235e139212dc4068bc359f7955e2792f", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.019
Average Set Size: 19
*********     Round 1: Early Stop Triggered at epoch 1308.    *********
Change in noise variance: 0.0429
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1367.    *********
Change in noise variance: 0.0066
Change in x0: 0.2664
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1393.    *********
Change in noise variance: 0.0024
Change in x0: 0.1964
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1497.    *********
Change in noise variance: 0.0011
Change in x0: 0.1703
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1589.    *********
Change in noise variance: 0.0008
Change in x0: 0.1515
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1655.    *********
Change in noise variance: 0.0000
Change in x0: 0.1359
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1699.    *********
Change in noise variance: 0.0000
Change in x0: 0.1163
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 1813.    *********
Change in noise variance: 0.0000
Change in x0: 0.1072
*********             Velocity Refinement Round 9             *********
Stage 2: Early Stop Triggered at round 8.
*********              Finished. Total Time =   0 h :  2 m : 21 s             *********
Final: Train ELBO = 616.538,	Test ELBO = 526.494
Run 25, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_25.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "92286ad4ac4f4ca69304ea105d042181", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 453 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c223858e5ea343fb815ba0f385525836", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e6d726e5ba4d4cd0b15a91ff81b43786", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.52, 0.28603679504748397), (0.48, 0.7673497264953757)
(0.37, 0.33761410289326726), (0.63, 0.8504461451142085)
KS-test result: [0. 1. 0.]
Initial induction: 369, repression: 209/578
Learning Rate based on Data Sparsity: 0.0000
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3f2685f7bcaf48c08580d84fe3c559e0", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.011
Average Set Size: 46
Change in noise variance: 0.2165
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1581.    *********
Change in noise variance: 0.0129
Change in x0: 0.9887
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1718.    *********
Change in noise variance: 0.0076
Change in x0: 0.7500
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1729.    *********
Change in noise variance: 0.0109
Change in x0: 0.6287
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1766.    *********
Change in noise variance: 0.0053
Change in x0: 0.5312
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1773.    *********
Change in noise variance: 0.0021
Change in x0: 0.4532
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1797.    *********
Change in noise variance: 0.0049
Change in x0: 0.3519
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 1828.    *********
Change in noise variance: 0.0057
Change in x0: 0.2352
*********             Velocity Refinement Round 9             *********
*********     Round 9: Early Stop Triggered at epoch 1854.    *********
Change in noise variance: 0.0038
Change in x0: 0.1470
*********             Velocity Refinement Round 10             *********
*********     Round 10: Early Stop Triggered at epoch 1896.    *********
Change in noise variance: 0.0015
Change in x0: 0.1019
*********             Velocity Refinement Round 11             *********
*********     Round 11: Early Stop Triggered at epoch 1907.    *********
Change in noise variance: 0.0004
Change in x0: 0.0837
*********             Velocity Refinement Round 12             *********
*********     Round 12: Early Stop Triggered at epoch 1946.    *********
Change in noise variance: 0.0000
Change in x0: 0.0917
*********             Velocity Refinement Round 13             *********
Stage 2: Early Stop Triggered at round 12.
*********              Finished. Total Time =   0 h :  2 m : 36 s             *********
Final: Train ELBO = -1092.304,	Test ELBO = -1252.312
Run 26, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_20.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9ddb22db55734eb6b89b7fac1140bf61", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 280 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ec3db07a331e4d588532d7b0e6468b01", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a8a9c42908524b798c471474b4cfb062", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
KS-test result: [1. 1. 1.]
Assign cluster 2 to repressive
Initial induction: 201, repression: 88/289
Learning Rate based on Data Sparsity: 0.0004
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "58696839aec44b94af4ca4746d24efc9", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.118
Average Set Size: 19
*********     Round 1: Early Stop Triggered at epoch 1452.    *********
Change in noise variance: 0.0595
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1629.    *********
Change in noise variance: 0.0121
Change in x0: 0.2074
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1705.    *********
Change in noise variance: 0.0010
Change in x0: 0.1123
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1817.    *********
Change in noise variance: 0.0002
Change in x0: 0.0804
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1986.    *********
Change in noise variance: 0.0000
Change in x0: 0.0608
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 2155.    *********
Change in noise variance: 0.0000
Change in x0: 0.0600
*********             Velocity Refinement Round 7             *********
Stage 2: Early Stop Triggered at round 6.
*********              Finished. Total Time =   0 h :  2 m : 44 s             *********
Final: Train ELBO = 523.419,	Test ELBO = 410.966
Run 27, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_7.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1ed7664cfe644219b6a99db688c839d4", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 347 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1aa3d5d1063740c8b9a975cb29e0e4b5", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "78ee37fb0b0f461696d4abfbb1b71ad5", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.35, 0.3338688963765141), (0.65, 0.8501683610682383)
(0.43, 0.26033194504377993), (0.57, 0.7905961327414116)
KS-test result: [0. 1. 0.]
Initial induction: 340, repression: 141/481
Learning Rate based on Data Sparsity: 0.0000
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4852a67faa984565ab26c793ed6aac32", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.033
Average Set Size: 20
*********     Round 1: Early Stop Triggered at epoch 1416.    *********
Change in noise variance: 0.0589
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1478.    *********
Change in noise variance: 0.0218
Change in x0: 0.4051
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1590.    *********
Change in noise variance: 0.0033
Change in x0: 0.3137
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1666.    *********
Change in noise variance: 0.0026
Change in x0: 0.2701
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1695.    *********
Change in noise variance: 0.0013
Change in x0: 0.2180
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1762.    *********
Change in noise variance: 0.0009
Change in x0: 0.1583
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1769.    *********
Change in noise variance: 0.0000
Change in x0: 0.1418
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 1776.    *********
Change in noise variance: 0.0000
Change in x0: 0.1210
*********             Velocity Refinement Round 9             *********
*********     Round 9: Early Stop Triggered at epoch 1828.    *********
Change in noise variance: 0.0000
Change in x0: 0.1092
*********             Velocity Refinement Round 10             *********
*********     Round 10: Early Stop Triggered at epoch 1902.    *********
Change in noise variance: 0.0000
Change in x0: 0.1064
*********             Velocity Refinement Round 11             *********
Stage 2: Early Stop Triggered at round 10.
*********              Finished. Total Time =   0 h :  2 m : 29 s             *********
Final: Train ELBO = -124.616,	Test ELBO = -153.157
Run 28, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_3.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ad2ec5c9cbc54c11b139c0c43696a500", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 148 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "179d368447034c12969418fc89a198aa", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "771f0874a2f94664afa899e85ca982c0", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
(0.41, 0.7019526186807664), (0.59, 0.16143693643502346)
KS-test result: [1. 0. 1.]
Initial induction: 137, repression: 71/208
Learning Rate based on Data Sparsity: 0.0000
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********       Stage 1: Early Stop Triggered at epoch 9.       *********
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "97d8810b536a48f097e9752295603a9b", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.030
Average Set Size: 20
*********     Round 1: Early Stop Triggered at epoch 18.    *********
Change in noise variance: 0.2526
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 25.    *********
Change in noise variance: 0.0175
Change in x0: 0.5068
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 34.    *********
Change in noise variance: 0.0136
Change in x0: 0.3108
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 43.    *********
Change in noise variance: 0.0037
Change in x0: 0.1939
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 52.    *********
Change in noise variance: 0.0009
Change in x0: 0.1428
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 59.    *********
Change in noise variance: 0.0000
Change in x0: 0.1115
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 73.    *********
Change in noise variance: 0.0000
Change in x0: 0.1003
*********             Velocity Refinement Round 8             *********
*********     Round 8: Early Stop Triggered at epoch 82.    *********
Change in noise variance: 0.0000
Change in x0: 0.0981
*********             Velocity Refinement Round 9             *********
Stage 2: Early Stop Triggered at round 8.
*********              Finished. Total Time =   0 h :  0 m :  7 s             *********
Final: Train ELBO = -37723.707,	Test ELBO = -37839.289
Run 29, file /ictstr01/groups/ml01/workspace/yifan.chen/regvelo_reproducibility/data/dyngen/complexity_1/processed/simulation_26.zarr.
Estimating ODE parameters...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0d80d4cc3536439f89070e20b91c00ba", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected 470 velocity genes.
Estimating the variance...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3b276b3a133041d18638382b5d974eb8", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization using the steady-state and dynamical models.
Reinitialize the regular ODE parameters based on estimated global latent time.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5bc483165b99467699f5190caf0ab5ee", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 clusters detected based on gene co-expression.
KS-test result: [1. 1. 1.]
Assign cluster 1 to repressive
Initial induction: 324, repression: 170/494
Learning Rate based on Data Sparsity: 0.0003
--------------------------- Train a VeloVAE ---------------------------
*********        Creating Training/Validation Datasets        *********
*********                      Finished.                      *********
*********                 Creating optimizers                 *********
*********                      Finished.                      *********
*********                    Start training                   *********
*********                      Stage  1                       *********
Total Number of Iterations Per Epoch: 6, test iteration: 10
*********       Stage 1: Early Stop Triggered at epoch 824.       *********
*********                      Stage  2                       *********
*********             Velocity Refinement Round 1             *********
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a003b331301d4f40b3733978267bea2a", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Invalid Sets: 0.118
Average Set Size: 19
*********     Round 1: Early Stop Triggered at epoch 1041.    *********
Change in noise variance: 0.0273
*********             Velocity Refinement Round 2             *********
*********     Round 2: Early Stop Triggered at epoch 1113.    *********
Change in noise variance: 0.0124
Change in x0: 0.2851
*********             Velocity Refinement Round 3             *********
*********     Round 3: Early Stop Triggered at epoch 1132.    *********
Change in noise variance: 0.0018
Change in x0: 0.1825
*********             Velocity Refinement Round 4             *********
*********     Round 4: Early Stop Triggered at epoch 1156.    *********
Change in noise variance: 0.0004
Change in x0: 0.1316
*********             Velocity Refinement Round 5             *********
*********     Round 5: Early Stop Triggered at epoch 1182.    *********
Change in noise variance: 0.0000
Change in x0: 0.1173
*********             Velocity Refinement Round 6             *********
*********     Round 6: Early Stop Triggered at epoch 1204.    *********
Change in noise variance: 0.0000
Change in x0: 0.0974
*********             Velocity Refinement Round 7             *********
*********     Round 7: Early Stop Triggered at epoch 1228.    *********
Change in noise variance: 0.0000
Change in x0: 0.0896
*********             Velocity Refinement Round 8             *********
Stage 2: Early Stop Triggered at round 7.
*********              Finished. Total Time =   0 h :  1 m : 38 s             *********
Final: Train ELBO = 594.783,	Test ELBO = 521.406
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-saving">
<h2>Data saving<a class="headerlink" href="#data-saving" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">SAVE_DATA</span><span class="p">:</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;velocity&quot;</span><span class="p">:</span> <span class="n">velocity_correlation</span><span class="p">})</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="n">DATASET</span> <span class="o">/</span> <span class="n">COMPLEXITY</span> <span class="o">/</span> <span class="s2">&quot;results&quot;</span> <span class="o">/</span> <span class="s2">&quot;velovae_fullvb_correlation.parquet&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "regvelo-py310-velovae"
        },
        kernelOptions: {
            name: "regvelo-py310-velovae",
            path: "./dyngen"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'regvelo-py310-velovae'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3_unitvelo.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">UniTVelo benchmark on dyngen data</p>
      </div>
    </a>
    <a class="right-next"
       href="3_velovae.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">VeloVAE benchmark on dyngen data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#library-imports">Library imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-settings">General settings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constants">Constants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#velocity-pipeline">Velocity pipeline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-saving">Data saving</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Weixu Wang, Philipp Weiler
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>